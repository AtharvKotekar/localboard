(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{164:(e,r,a)=>{Promise.resolve().then(a.t.bind(a,3673,23)),Promise.resolve().then(a.bind(a,1882))},1882:(e,r,a)=>{"use strict";a.d(r,{AuthProvider:()=>u});var t=a(5155),i=a(2115);let l=(0,a(5040).UU)("https://oiwlokcgzvkdtzvomxmc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9pd2xva2NnenZrZHR6dm9teG1jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY0NzI0MTMsImV4cCI6MjA3MjA0ODQxM30.5_tAl4K91s3_ZAc2VNMtWvtCPU7T9aCMJkLwkNh5PRE");var n=a(5704);let s=(0,i.createContext)(void 0),o=[{id:"demo-admin",email:"admin@hackerhouse.dev",password:"admin123",name:"Admin User",role:"misc",tagline:"Managing the house like a boss",is_admin:!0,avatar_url:null,created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z"},{id:"demo-alice",email:"alice@hackerhouse.dev",password:"demo123",name:"Alice Chen",role:"coder",tagline:"Full-stack wizard building the next unicorn",is_admin:!1,avatar_url:null,created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z"},{id:"demo-tv",email:"tv@hackerhouse.dev",password:"tv123",name:"TV Display",role:"misc",tagline:"Showing house stats 24/7",is_admin:!1,avatar_url:null,created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z"}];function u(e){let{children:r}=e,[a,u]=(0,i.useState)(null),[d,c]=(0,i.useState)(null),[m,h]=(0,i.useState)(!0),v="true"===n.env.NEXT_PUBLIC_DEMO_MODE,_=async()=>{if(a&&!v)try{let{data:e,error:r}=await l.from("users").select("*").eq("id",a.id).single();!r&&e&&c(e)}catch(e){console.error("Error fetching profile:",e)}};(0,i.useEffect)(()=>{if(v)return void h(!1);(async()=>{try{var e;let{data:{session:r}}=await l.auth.getSession();u(null!=(e=null==r?void 0:r.user)?e:null),(null==r?void 0:r.user)&&await _()}catch(e){console.error("Error getting initial session:",e)}finally{h(!1)}})();let{data:{subscription:e}}=l.auth.onAuthStateChange(async(e,r)=>{var a;u(null!=(a=null==r?void 0:r.user)?a:null),(null==r?void 0:r.user)?await _():c(null),h(!1)});return()=>e.unsubscribe()},[]);let g=async(e,r)=>{try{if(v){let a=o.find(a=>a.email===e&&a.password===r);if(!a)return{error:{message:"Invalid email or password"}};let t={id:a.id,email:a.email,created_at:a.created_at};return u(t),c({...a,avatar_url:a.avatar_url||void 0}),{error:null}}let{data:a,error:t}=await l.auth.signInWithPassword({email:e,password:r});return{error:t}}catch(e){return{error:e}}},w=async(e,r,a)=>{try{if(v){let r={id:"demo-".concat(Date.now()),email:e,name:a.name,role:a.role,tagline:a.tagline||"",is_admin:!1,avatar_url:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},t={id:r.id,email:r.email,created_at:r.created_at};return u(t),c({...r,avatar_url:r.avatar_url||void 0}),{error:null}}let{data:t,error:i}=await l.auth.signUp({email:e,password:r});if(i)return{error:i};if(t.user){let{error:r}=await l.from("users").insert({id:t.user.id,email:e,name:a.name,role:a.role,tagline:a.tagline||"",is_admin:!1});if(r)return console.error("Error creating profile:",r),{error:r}}return{error:null}}catch(e){return{error:e}}},p=async()=>{try{v||await l.auth.signOut(),u(null),c(null)}catch(e){console.error("Error signing out:",e)}};return(0,t.jsx)(s.Provider,{value:{user:a,profile:d,loading:m,signIn:g,signUp:w,signOut:p,refreshProfile:_},children:r})}},3673:()=>{}},e=>{e.O(0,[978,40,441,255,358],()=>e(e.s=164)),_N_E=e.O()}]);